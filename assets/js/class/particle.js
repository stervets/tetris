// Generated by CoffeeScript 1.7.1
(function() {
  Application.Particle = (function() {
    Particle.prototype.params = {
      x: 0,
      y: 0,
      distanceX: 0,
      distanceY: 30,
      lifetime: 300,
      particlesMax: 5,
      particleNum: 120,
      messageNum: 5
    };

    Particle.prototype.color = ['#FFFFFF', '#98eb2f', '#ffd739', '#70e8a0', '#4baaef', '#f36252', '#af6cbb'];

    Particle.prototype.particleHtml = $('#tplParticle').html();

    Particle.prototype.messageHtml = $('#tplMessage').html();

    Particle.prototype.sparkHtml = $('#tplSpark').html();

    Particle.prototype.$el = null;

    Particle.prototype.play = false;

    Particle.prototype.stepTime = 10;

    Particle.prototype.$particle = [];

    Particle.prototype.$message = [];

    Particle.prototype.particlePointer = 0;

    Particle.prototype.messagePointer = 0;

    Particle.prototype.launch = function(x, y, color, x2) {
      var $p;
      $p = this.$particle[this.particlePointer];
      $p.css({
        top: y + this.params.y,
        left: x + this.params.x,
        opacity: 1,
        rotate: "" + (rand(-180, 180)) + "deg",
        scale: 2.5,
        color: this.color[color],
        transition: 'none'
      });
      _.delay(function($p, params, x, y, x2) {
        $p.css({
          top: y + rand(0, params.distanceY) + params.y,
          left: (x2 != null ? x2 : x) + params.x,
          scale: 0,
          rotate: "" + (rand(-180, 180)) + "deg",
          color: 'white',
          transition: "all " + params.lifetime + "ms ease-out"
        });
        return null;
      }, this.stepTime, $p, this.params, x, y, x2);
      if (++this.particlePointer >= this.$particle.length) {
        return this.particlePointer = 0;
      }
    };

    Particle.prototype.message = function(text, y, color) {
      var $p;
      if (color == null) {
        color = 0;
      }
      $p = this.$message[this.messagePointer];
      $p.text(text).css({
        top: this.params.y + y,
        left: this.params.x,
        opacity: 1,
        color: this.color[color],
        transition: 'none'
      });
      _.delay(function($p, params, y) {
        $p.css({
          top: params.y - params.distanceY + y,
          opacity: 0,
          transition: "all " + (params.lifetime * 2) + "ms ease-out"
        });
        return null;
      }, this.stepTime, $p, this.params, y);
      if (++this.messagePointer >= this.$message.length) {
        return this.messagePointer = 0;
      }
    };

    function Particle(params) {
      var $message, $spark, i, _i, _j, _ref, _ref1;
      _(this.params).extend(params);
      this.$el = $(this.particleHtml);
      this.$particle = [];
      for (i = _i = 1, _ref = this.params.particleNum; 1 <= _ref ? _i <= _ref : _i >= _ref; i = 1 <= _ref ? ++_i : --_i) {
        $spark = $(this.sparkHtml);
        this.$particle.push($spark);
        this.$el.append($spark);
      }
      this.$message = [];
      for (i = _j = 1, _ref1 = this.params.messageNum; 1 <= _ref1 ? _j <= _ref1 : _j >= _ref1; i = 1 <= _ref1 ? ++_j : --_j) {
        $message = $(this.messageHtml);
        this.$message.push($message);
        this.$el.append($message);
      }
    }

    return Particle;

  })();

}).call(this);

//# sourceMappingURL=particle.map
