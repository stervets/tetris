{
  "version": 3,
  "file": "game.js",
  "sourceRoot": "/",
  "sources": [
    "game.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\nspellCast = (lines, score, combo)->\n    pool = Application.Pool.at(if Application.Pool.at(0).id is @id then 1 else 0)\n    if value = lines.length+combo-2\n        spellValue = @getSpell(SPELL.GROUND)-value\n        @setSpell SPELL.GROUND, if spellValue>0 then spellValue else 0\n        pool.setSpell SPELL.GROUND, pool.getSpell()+Math.abs(spellValue)\n\n\nclass Application.Model.Player extends Backbone.Model\n    defaults:\n        name: 'PLayer'\n        rating: 0\n\n###\n#   GAME MODEL\n###\nclass Application.Model.Game extends Backbone.Model\n    defaults:\n        mode: null\n\n    proc: {}\n\n    gameReset: ->\n        @proc = {}\n        Application.shapeStack.reset()\n        Application.shapeStack.generateShapes(4)\n        Application.Pool.reset()\n        Application.Controller.reset()\n\n    switch: (mode, param)-> if @attributes.mode is mode then @trigger('change:mode', @, mode, param) else @set('mode', mode, param)\n\n    mode: [\n        #loading\n        ->\n        #Lobby\n        ->\n            @gameReset()\n\n        # Single player\n        (isCPU)->\n            @gameReset()\n\n            if isCPU is true\n              @proc.controller = new Application.Model.Controller.AI\n                  formula: CPU[0].FORMULA\n                  smart: CPU[0].SMART\n                  actionDelay: 150\n            else\n              @proc.controller = new Application.Model.Controller.User()\n\n            Application.Controller.add(@proc.controller)\n            @proc.pool = new Application.Model.Pool\n                controller: @proc.controller.id\n            Application.Pool.add(@proc.pool)\n            @proc.controller.start()\n\n        #PLayer vs CPU\n        ->\n            @gameReset()\n            @proc.controller1 = new Application.Model.Controller.User()\n\n            Application.Controller.add(@proc.controller1)\n            @proc.pool1 = new Application.Model.Pool\n                controller: @proc.controller1.id\n            Application.Pool.add(@proc.pool1)\n            @proc.controller1.start()\n\n            @proc.controller2 = new Application.Model.Controller.AI\n                formula: CPU[0].FORMULA\n                smart: CPU[0].SMART - 20\n            Application.Controller.add(@proc.controller2)\n            @proc.pool2 = new Application.Model.Pool\n                controller: @proc.controller2.id\n            Application.Pool.add(@proc.pool2)\n            @proc.controller2.start()\n\n            @proc.pool1.on 'lines', spellCast, @proc.pool1\n            @proc.pool2.on 'lines', spellCast, @proc.pool2\n\n        #CPU vs CPU\n        ->\n            actionDelay = 150\n            @gameReset()\n            @proc.controller1 = new Application.Model.Controller.AI\n                formula: CPU[0].FORMULA\n                smart: CPU[0].SMART\n                actionDelay: actionDelay\n            Application.Controller.add(@proc.controller1)\n            @proc.pool1 = new Application.Model.Pool\n                controller: @proc.controller1.id\n            Application.Pool.add(@proc.pool1)\n            @proc.controller1.start()\n\n            @proc.controller2 = new Application.Model.Controller.AI\n                formula: CPU[1].FORMULA\n                smart: CPU[1].SMART\n                actionDelay: actionDelay\n            Application.Controller.add(@proc.controller2)\n            @proc.pool2 = new Application.Model.Pool\n                controller: @proc.controller2.id\n            Application.Pool.add(@proc.pool2)\n            @proc.controller2.start()\n\n            @proc.pool1.on 'lines', spellCast, @proc.pool1\n            @proc.pool2.on 'lines', spellCast, @proc.pool2\n\n    ]\n\n    handler:\n        'change:mode': (model, mode, param)-> @mode[mode].call(@, param) if @mode[mode]?\n\n    init: ->\n        #@gameReset()\n        #@set 'status', STATUS.LOBBY\n        #@gameStart()\n\n###\n#   GAME VIEW\n###\nclass Application.View.Game extends Backbone.View\n    node: '#jsGame'\n\n    mode: [\n        #Loading\n        ->\n        #Lobby\n        ->\n            #Application.switchView('Lobby')\n        # Single player\n        (isCPU)->\n            @model.proc.view = new Application.View.Pool\n                x: 900/2 - 450/2\n                y: 50\n                model: @model.proc.pool\n\n            @$('#jsSinglePlay').html(@model.proc.view.$el)\n\n            @model.proc.onGameOver = =>\n                Application.Sound.musicStop()\n                @$('#jsSinglePlayGameOver .jsScore').text(@model.proc.pool.score)\n                @$('#jsSinglePlayGameOver')\n                .css\n                    opacity: 0\n                    scale: 0\n                .show()\n                .transition\n                    opacity: 1\n                    scale: 1\n                    , VIEW_ANIMATE_TIME\n\n            @listenTo @model.proc.pool, 'gameover', @model.proc.onGameOver\n            Application.Sound.musicPlay()\n\n        #PLayer vs CPU\n        ->\n            @model.proc.view1 = new Application.View.Pool\n                x: 450/2 - 450/2\n                y: 50\n                model: @model.proc.pool1\n            @$('#jsPlayerVsCpu').html(@model.proc.view1.$el)\n\n            @model.proc.view2 = new Application.View.Pool\n                x: 1350/2 - 450/2\n                y: 50\n                model: @model.proc.pool2\n            @$('#jsPlayerVsCpu').append(@model.proc.view2.$el)\n\n            @model.proc.onGameOver = =>\n                @model.proc.pool1.trigger 'action', 'stop'\n                @model.proc.pool2.trigger 'action', 'stop'\n\n                Application.Sound.musicStop()\n                @$('.jsGameOverWinLoose').hide()\n\n                if @model.proc.pool1.score == @model.proc.pool2.score\n                    @$('.jsGameOverDraw').show()\n                else\n                    if @model.proc.pool1.score>=@model.proc.pool2.score\n                        @$('.jsGameOverWin').show()\n                    else\n                        @$('.jsGameOverLoose').show()\n\n                @$('#jsPlayerVsCpuGameOver .jsScore').text(@model.proc.pool1.score)\n                @$('#jsPlayerVsCpuGameOver')\n                .css\n                        opacity: 0\n                        scale: 0\n                .show()\n                .transition\n                        opacity: 1\n                        scale: 1\n                        , VIEW_ANIMATE_TIME\n\n            @listenTo @model.proc.pool1, 'gameover', @model.proc.onGameOver\n            @listenTo @model.proc.pool2, 'gameover', @model.proc.onGameOver\n            Application.Sound.musicPlay()\n\n        #CPU vs CPU\n        ->\n            @model.proc.view1 = new Application.View.Pool\n                x: 450/2 - 450/2\n                y: 50\n                model: @model.proc.pool1\n            @$('#jsCpuVsCpu').html(@model.proc.view1.$el)\n\n            @model.proc.view2 = new Application.View.Pool\n                x: 1350/2 - 450/2\n                y: 50\n                model: @model.proc.pool2\n            @$('#jsCpuVsCpu').append(@model.proc.view2.$el)\n\n            @model.proc.onGameOver = =>\n                @model.proc.pool1.trigger 'action', 'stop'\n                @model.proc.pool2.trigger 'action', 'stop'\n\n                Application.Sound.musicStop()\n                @$('.jsGameOverWinLoose').hide()\n\n                if @model.proc.pool1.score == @model.proc.pool2.score\n                    @$('.jsGameOverDraw').show()\n                else\n                    if @model.proc.pool1.score>=@model.proc.pool2.score\n                        @$('.jsGameOverCpu1').show()\n                    else\n                        @$('.jsGameOverCpu2').show()\n\n                @$('#jsCpuVsCpuGameOver .jsScoreCpu1').text(@model.proc.pool1.score)\n                @$('#jsCpuVsCpuGameOver .jsScoreCpu2').text(@model.proc.pool2.score)\n\n                @$('#jsCpuVsCpuGameOver')\n                .css\n                        opacity: 0\n                        scale: 0\n                .show()\n                .transition\n                        opacity: 1\n                        scale: 1\n                        , VIEW_ANIMATE_TIME\n\n            @listenTo @model.proc.pool1, 'gameover', @model.proc.onGameOver\n            @listenTo @model.proc.pool2, 'gameover', @model.proc.onGameOver\n            Application.Sound.musicPlay()\n    ]\n\n    modelHandler:\n        change: ->\n\n        'change:mode': (model, mode, param)->\n            if @mode[mode]?\n                delay = if @$('.game-inner:visible').length then VIEW_ANIMATE_TIME else 0\n            $gameInner = @$('.game-inner')\n            $gameInner.transition\n                opacity: 0\n                , _.once =>\n                    @$('.game-inner').hide()\n                    @mode[mode].call @, param\n\n                    $($gameInner[mode])\n                    .css\n                        opacity: 0\n                    .show()\n                    .transition opacity: 1, delay\n                , delay\n\n    init: ->\n        @$('#jsSinglePlayGameOver .jsPlayAgain')\n            .click ->\n                Application.Game.switch(GAME_MODE.SINGLE_PLAYER)\n\n        @$('#jsPlayerVsCpuGameOver .jsPlayAgain')\n            .click ->\n                Application.Game.switch(GAME_MODE.PLAYER_VS_CPU)\n\n        @$('#jsCpuVsCpuGameOver .jsPlayAgain')\n            .click ->\n                Application.Game.switch(GAME_MODE.CPU_VS_CPU)\n\n        @$('.jsExitToMenu, #jsControlMenu')\n            .click ->\n                Application.Game.switch(GAME_MODE.LOBBY)\n\n        $('body').keyup (e)->\n          Application.Game.switch(GAME_MODE.LOBBY) if e.keyCode is 27\n\n        disabled = 'button-disabled'\n\n        @$('#jsControlSound, #jsControlMusic').click ->\n            console.log \"here\"\n            $this = $(this)\n            $this.toggleClass disabled\n            turnOff = $this.is \".#{disabled}\"\n            id = $this.attr('id')\n            Application.Sound.switchAudio(id is 'jsControlSound', !turnOff)\n            window.localStorage.setItem(id, turnOff)\n\n\n\n        $(window)\n            .blur ->\n                    Application.Pool.each (pool)->\n                        pool.trigger 'action', 'stop'\n            .focus ->\n                    Application.Pool.each (pool)->\n                        pool.trigger 'action', 'start'\n"
  ]
}